version: 2

models:
  - name: fct_vendas_item
    description: "Esta tabela reúne informações na maior granularidade, a nível de produto."
    columns:
      - name: cliente_fk
        description: "Chave estrangeira para a tabela de cliente."
        tests:
          - relationships:
              to: ref('dim_cliente')
              field: sk_cliente
          - not_null    
      - name: vendedor_fk
        description: "Chave estrangeira para a tabela de vendedores."
        tests:
          - relationships:
              to: ref('dim_vendedor')
              field: sk_vendedor
      - name: regiao_fk
        description: "Chave estrangeira para a tabela de regiões."
        tests:
          - relationships:
              to: ref('dim_regiao')
              field: sk_regiao
      - name: cartao_credito_fk
        description: "Chave estrangeira para a tabela de cartão de crédito."
        tests:
          - relationships:
              to: ref('dim_cartaocredito')
              field: sk_cartaocredito
      - name: data_fk
        description: "Chave estrangeira para a tabela de data/calendário."
        tests:
          - relationships:
              to: ref('dim_data')
              field: sk_data
      - name: produto_fk
        description: "Chave estrangeira para a tabela de produtos."
        tests:
          - relationships:
              to: ref('dim_produto')
              field: sk_produto
      - name: id_pedido
        description: "Identificador único do pedido."
        tests:
          - not_null
      - name: dt_pedido
        description: "Data em que o pedido foi feito."
      - name: dt_devida_entrega
        description: "Data em que o pedido é devido ao cliente."
      - name: dt_envio
        description: "Data em que o pedido foi enviado ao cliente."
      - name: dt_modificacao
        description: "Data de modificação do registro."
      - name: st_pedido
        description: >
          "Status atual do pedido, podendo ser: 1 = Em processo; 2 = Aprovado; 3 = Pedido em espera; 
          4 = Rejeitado; 5 = Enviado; 6 = Cancelado "
      - name: canal_venda
        description: "Indica por qual canal a venda foi feita, podendo ser Físico ou Online."
      - name: vr_subtotal_pedido
        description: "Subtotal de vendas. Calculado como SUM(SalesOrderDetail.LineTotal) para o SalesOrderID apropriado."
      - name: vr_imposto_pedido
        description: "Valor do imposto para o pedido."
      - name: vr_frete_pedido
        description: "Valor de frete para o pedido."
      - name: vr_total_devido 
        description: "Total devido pelo cliente. Calculado como vr_subtotal + vr_imposto_pedido + vr_frete_pedido."
      - name: vr_produto 
        description: "Preço de venda de um único produto."
      - name: vr_desconto 
        description: "Valor do desconto."
      - name: qt_encomendada_produto
        description: "Quantidade encomendada por produto."
